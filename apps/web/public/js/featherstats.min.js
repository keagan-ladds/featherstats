"use strict";(()=>{var u="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var f=(s=21)=>{let t="",e=crypto.getRandomValues(new Uint8Array(s|=0));for(;s--;)t+=u[e[s]&63];return t};var p={batchSize:10,flushInterval:1e4,baseUrl:"http://localhost:3000"},a=class{eventQueue=[];config;apiKey;sessionId;flushTimeout;isDestroyed=!1;constructor(t,e){this.apiKey=t,this.sessionId=this.getSessionId(),this.config={...p,...e},this.startFlushInterval()}getSessionId(){let t=sessionStorage.getItem("sessionId");return t||(t=f(),sessionStorage.setItem("sessionId",t),t)}startFlushInterval(){this.flushTimeout&&clearInterval(this.flushTimeout),this.flushTimeout=setInterval(()=>{this.isDestroyed||this.flush().catch(t=>{console.error("Error in flush interval:",t)})},this.config.flushInterval),this.flushTimeout.unref&&this.flushTimeout.unref()}async track(t,e={}){if(this.isDestroyed){console.warn("Attempting to track event on destroyed telemetry service");return}let i={eventType:t,sessionId:this.sessionId,timestamp:new Date().toISOString(),payload:e.payload||{}};this.eventQueue.push(i),this.eventQueue.length>=this.config.batchSize&&await this.flush()}async flush(){if(this.eventQueue.length===0||this.isDestroyed)return;let t=[...this.eventQueue];this.eventQueue=[];try{await this.sendEvents(t)}catch(e){console.error("Failed to send telemetry events:",e),this.isDestroyed||(this.eventQueue=[...t,...this.eventQueue])}}async sendEvents(t){await fetch(`${this.config.baseUrl}/api/v1/event`,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":this.apiKey},body:JSON.stringify({events:t})})}cleanup(){this.isDestroyed=!0,this.flush().catch(t=>{console.error("Error in cleanup flush:",t)}),this.flushTimeout&&(clearInterval(this.flushTimeout),this.flushTimeout=void 0)}};function m(){let s=document.getElementsByTagName("script"),t=s[s.length-1],e=window.FEATHERSTATS_API_KEY||t.getAttribute("data-api-key");if(!e){console.error("Featherstats: No API key provided");return}let i={referrer:document.referrer,pathname:window.location.pathname},r=new a(e,{baseUrl:"http://localhost:3000"});r.track("page_hit",{payload:i});let n=window;n.featherstats=n.featherstats||{};let d=n.featherstats.q||[];n.featherstats={track:(l,h)=>r.track(l,{payload:h}),instance:r},d.forEach(([l,...h])=>{let c=n.featherstats[l];typeof c=="function"&&c.apply(null,h)});let o=location.pathname;window.addEventListener("click",function(){location.pathname!=o&&(o=location.pathname,r.track("page_hit",{payload:{...i,pathname:o}}))})}m();})();
